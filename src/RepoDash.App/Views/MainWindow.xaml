<Window x:Class="RepoDash.App.Views.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:controls="clr-namespace:RepoDash.App.Controls"
        xmlns:viewModels="clr-namespace:RepoDash.App.ViewModels"
        mc:Ignorable="d"
        Title="RepoDash"
        WindowStartupLocation="CenterScreen"
        Height="720"
        Width="1200">
    <Window.Resources>
        <ItemsPanelTemplate x:Key="GroupPanelTemplate">
            <WrapPanel IsItemsHost="True" Orientation="Horizontal" ItemWidth="360" MinWidth="360" />
        </ItemsPanelTemplate>
    </Window.Resources>

    <Grid Background="{StaticResource WindowBackgroundBrush}">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <Border Grid.Row="0"
                Padding="12"
                Background="{StaticResource PanelBackgroundBrush}"
                BorderBrush="{StaticResource PanelBorderBrush}"
                BorderThickness="0,0,0,1">
            <Grid VerticalAlignment="Center">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="3*" />
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="2*" />
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>

                <Grid VerticalAlignment="Center">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition />
                        <ColumnDefinition Width="Auto" />
                    </Grid.ColumnDefinitions>
                    <TextBox x:Name="SearchBox"
                             VerticalContentAlignment="Center"
                             Padding="8,4"
                             FontSize="14"
                             Background="{StaticResource WindowBackgroundBrush}"
                             BorderBrush="{StaticResource PanelBorderBrush}"
                             Text="{Binding SearchText, UpdateSourceTrigger=PropertyChanged}" />
                    <Button Grid.Column="1"
                            Content="?"
                            Margin="6,0,0,0"
                            Width="28"
                            Height="28"
                            Click="OnClearSearch" />
                </Grid>

                <StackPanel Grid.Column="1" Orientation="Horizontal" VerticalAlignment="Center">
                    <TextBlock Text="List height" Margin="0,0,6,0" VerticalAlignment="Center" Foreground="{StaticResource TextSecondaryBrush}" />
                    <controls:NumericUpDown Value="{Binding ListItemHeight}" Minimum="32" Maximum="160" />
                </StackPanel>

                <TextBox Grid.Column="2"
                         Padding="8,4"
                         VerticalContentAlignment="Center"
                         Background="{StaticResource WindowBackgroundBrush}"
                         BorderBrush="{StaticResource PanelBorderBrush}"
                         Text="{Binding RepoRoot, UpdateSourceTrigger=PropertyChanged}" />

                <Button Grid.Column="3" Content="Refresh" Command="{Binding RefreshCommand}" />
                <Button Grid.Column="4" Content="Settings" Margin="6,0,0,0" />
                <Button Grid.Column="5" Content="Git" Margin="6,0,0,0" />
            </Grid>
        </Border>

        <Border Grid.Row="1"
                Margin="12"
                Padding="8"
                Background="{StaticResource PanelBackgroundBrush}"
                Visibility="{Binding SuggestionsVisible, Converter={StaticResource BoolToVisibilityConverter}}">
            <ItemsControl ItemsSource="{Binding Suggestions}">
                <ItemsControl.ItemTemplate>
                    <DataTemplate DataType="{x:Type viewModels:RepoItemViewModel}">
                        <TextBlock Text="{Binding DisplayName}" FontSize="14" Margin="4" />
                    </DataTemplate>
                </ItemsControl.ItemTemplate>
            </ItemsControl>
        </Border>

        <ScrollViewer Grid.Row="2" Margin="12" VerticalScrollBarVisibility="Auto">
            <ItemsControl ItemsSource="{Binding Groups}" ItemsPanel="{StaticResource GroupPanelTemplate}">
                <ItemsControl.ItemTemplate>
                    <DataTemplate DataType="{x:Type viewModels:RepoGroupViewModel}">
                        <Border Width="{Binding ColumnWidth}"
                                Margin="0,0,12,12"
                                Padding="12"
                                Background="{StaticResource PanelBackgroundBrush}"
                                BorderBrush="{StaticResource PanelBorderBrush}"
                                BorderThickness="1"
                                CornerRadius="8">
                            <StackPanel>
                                <TextBlock Text="{Binding Header}" FontSize="16" FontWeight="SemiBold" Margin="0,0,0,8" />
                                <ListView ItemsSource="{Binding Items}"
                                          BorderThickness="0"
                                          Background="Transparent"
                                          ScrollViewer.VerticalScrollBarVisibility="Disabled">
                                    <ListView.ItemsPanel>
                                        <ItemsPanelTemplate>
                                            <VirtualizingStackPanel />
                                        </ItemsPanelTemplate>
                                    </ListView.ItemsPanel>
                                    <ListView.ItemContainerStyle>
                                        <Style TargetType="ListViewItem">
                                            <Setter Property="Padding" Value="0" />
                                            <Setter Property="Margin" Value="0" />
                                            <Setter Property="Height" Value="{Binding DataContext.ListItemHeight, RelativeSource={RelativeSource AncestorType=Window}}" />
                                            <Setter Property="HorizontalContentAlignment" Value="Stretch" />
                                        </Style>
                                    </ListView.ItemContainerStyle>
                                    <ListView.ItemTemplate>
                                        <DataTemplate DataType="{x:Type viewModels:RepoItemViewModel}">
                                            <Border Background="{StaticResource WindowBackgroundBrush}"
                                                    CornerRadius="6"
                                                    Margin="0,0,0,8"
                                                    Padding="12">
                                                <Grid>
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition />
                                                        <ColumnDefinition Width="Auto" />
                                                    </Grid.ColumnDefinitions>
                                                    <StackPanel>
                                                        <TextBlock Text="{Binding DisplayName}" FontWeight="Bold" />
                                                        <TextBlock Text="{Binding BranchText}" FontSize="11" Foreground="{Binding BranchBrush}" />
                                                    </StackPanel>
                                                    <StackPanel Grid.Column="1" Orientation="Horizontal" VerticalAlignment="Center">
                                                        <Button Content="??"
                                                                Margin="6,0,0,0"
                                                                ToolTip="Launch"
                                                                Command="{Binding DataContext.LaunchCommand, RelativeSource={RelativeSource AncestorType=Window}}"
                                                                CommandParameter="{Binding}"
                                                                Width="28"
                                                                Height="28" />
                                                    </StackPanel>
                                                </Grid>
                                            </Border>
                                        </DataTemplate>
                                    </ListView.ItemTemplate>
                                </ListView>
                            </StackPanel>
                        </Border>
                    </DataTemplate>
                </ItemsControl.ItemTemplate>
            </ItemsControl>
        </ScrollViewer>
    </Grid>
</Window>
